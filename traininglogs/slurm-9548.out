Defaulting to user installation because normal site-packages is not writeable
Requirement already satisfied: transformers in ./.local/lib/python3.10/site-packages (4.27.3)
Requirement already satisfied: datasets in ./.local/lib/python3.10/site-packages (2.10.1)
Requirement already satisfied: evaluate in ./.local/lib/python3.10/site-packages (0.4.0)
Requirement already satisfied: librosa in ./.local/lib/python3.10/site-packages (0.10.0.post2)
Requirement already satisfied: pyyaml>=5.1 in /app/python/3.10.5/lib/python3.10/site-packages (from transformers) (6.0)
Requirement already satisfied: regex!=2019.12.17 in ./.local/lib/python3.10/site-packages (from transformers) (2023.3.23)
Requirement already satisfied: filelock in ./.local/lib/python3.10/site-packages (from transformers) (3.10.2)
Requirement already satisfied: numpy>=1.17 in /app/python/3.10.5/lib/python3.10/site-packages (from transformers) (1.22.4)
Requirement already satisfied: packaging>=20.0 in /app/python/3.10.5/lib/python3.10/site-packages (from transformers) (21.3)
Requirement already satisfied: tqdm>=4.27 in ./.local/lib/python3.10/site-packages (from transformers) (4.65.0)
Requirement already satisfied: huggingface-hub<1.0,>=0.11.0 in ./.local/lib/python3.10/site-packages (from transformers) (0.13.3)
Requirement already satisfied: requests in /app/python/3.10.5/lib/python3.10/site-packages (from transformers) (2.28.1)
Requirement already satisfied: tokenizers!=0.11.3,<0.14,>=0.11.1 in ./.local/lib/python3.10/site-packages (from transformers) (0.13.2)
Requirement already satisfied: dill<0.3.7,>=0.3.0 in ./.local/lib/python3.10/site-packages (from datasets) (0.3.6)
Requirement already satisfied: aiohttp in /app/python/3.10.5/lib/python3.10/site-packages (from datasets) (3.8.3)
Requirement already satisfied: pyarrow>=6.0.0 in /app/python/3.10.5/lib/python3.10/site-packages (from datasets) (8.0.0)
Requirement already satisfied: xxhash in ./.local/lib/python3.10/site-packages (from datasets) (3.2.0)
Requirement already satisfied: multiprocess in ./.local/lib/python3.10/site-packages (from datasets) (0.70.14)
Requirement already satisfied: responses<0.19 in ./.local/lib/python3.10/site-packages (from datasets) (0.18.0)
Requirement already satisfied: pandas in /app/python/3.10.5/lib/python3.10/site-packages (from datasets) (1.4.3)
Requirement already satisfied: fsspec[http]>=2021.11.1 in /app/python/3.10.5/lib/python3.10/site-packages (from datasets) (2022.5.0)
Requirement already satisfied: scipy>=1.2.0 in /app/python/3.10.5/lib/python3.10/site-packages (from librosa) (1.8.1)
Requirement already satisfied: soxr>=0.3.2 in ./.local/lib/python3.10/site-packages (from librosa) (0.3.4)
Requirement already satisfied: soundfile>=0.12.1 in ./.local/lib/python3.10/site-packages (from librosa) (0.12.1)
Requirement already satisfied: scikit-learn>=0.20.0 in /app/python/3.10.5/lib/python3.10/site-packages (from librosa) (1.1.1)
Requirement already satisfied: typing-extensions>=4.1.1 in /app/python/3.10.5/lib/python3.10/site-packages (from librosa) (4.3.0)
Requirement already satisfied: lazy-loader>=0.1 in ./.local/lib/python3.10/site-packages (from librosa) (0.2)
Requirement already satisfied: audioread>=2.1.9 in ./.local/lib/python3.10/site-packages (from librosa) (3.0.0)
Requirement already satisfied: numba>=0.51.0 in /app/python/3.10.5/lib/python3.10/site-packages (from librosa) (0.55.2)
Requirement already satisfied: joblib>=0.14 in /app/python/3.10.5/lib/python3.10/site-packages (from librosa) (1.1.0)
Requirement already satisfied: pooch<1.7,>=1.0 in ./.local/lib/python3.10/site-packages (from librosa) (1.6.0)
Requirement already satisfied: msgpack>=1.0 in /app/python/3.10.5/lib/python3.10/site-packages (from librosa) (1.0.4)
Requirement already satisfied: decorator>=4.3.0 in /app/python/3.10.5/lib/python3.10/site-packages (from librosa) (5.1.1)
Requirement already satisfied: llvmlite<0.39,>=0.38.0rc1 in /app/python/3.10.5/lib/python3.10/site-packages (from numba>=0.51.0->librosa) (0.38.1)
Requirement already satisfied: setuptools in /app/python/3.10.5/lib/python3.10/site-packages (from numba>=0.51.0->librosa) (58.1.0)
Requirement already satisfied: pyparsing!=3.0.5,>=2.0.2 in /app/python/3.10.5/lib/python3.10/site-packages (from packaging>=20.0->transformers) (3.0.9)
Requirement already satisfied: appdirs>=1.3.0 in /app/python/3.10.5/lib/python3.10/site-packages (from pooch<1.7,>=1.0->librosa) (1.4.4)
Requirement already satisfied: certifi>=2017.4.17 in /app/python/3.10.5/lib/python3.10/site-packages (from requests->transformers) (2022.6.15)
Requirement already satisfied: urllib3<1.27,>=1.21.1 in /app/python/3.10.5/lib/python3.10/site-packages (from requests->transformers) (1.26.9)
Requirement already satisfied: charset-normalizer<3,>=2 in /app/python/3.10.5/lib/python3.10/site-packages (from requests->transformers) (2.1.0)
Requirement already satisfied: idna<4,>=2.5 in /app/python/3.10.5/lib/python3.10/site-packages (from requests->transformers) (3.3)
Requirement already satisfied: threadpoolctl>=2.0.0 in /app/python/3.10.5/lib/python3.10/site-packages (from scikit-learn>=0.20.0->librosa) (3.1.0)
Requirement already satisfied: cffi>=1.0 in /app/python/3.10.5/lib/python3.10/site-packages (from soundfile>=0.12.1->librosa) (1.15.1)
Requirement already satisfied: yarl<2.0,>=1.0 in /app/python/3.10.5/lib/python3.10/site-packages (from aiohttp->datasets) (1.8.1)
Requirement already satisfied: aiosignal>=1.1.2 in /app/python/3.10.5/lib/python3.10/site-packages (from aiohttp->datasets) (1.2.0)
Requirement already satisfied: attrs>=17.3.0 in /app/python/3.10.5/lib/python3.10/site-packages (from aiohttp->datasets) (22.1.0)
Requirement already satisfied: multidict<7.0,>=4.5 in /app/python/3.10.5/lib/python3.10/site-packages (from aiohttp->datasets) (6.0.2)
Requirement already satisfied: frozenlist>=1.1.1 in /app/python/3.10.5/lib/python3.10/site-packages (from aiohttp->datasets) (1.3.1)
Requirement already satisfied: async-timeout<5.0,>=4.0.0a3 in /app/python/3.10.5/lib/python3.10/site-packages (from aiohttp->datasets) (4.0.2)
Requirement already satisfied: pytz>=2020.1 in /app/python/3.10.5/lib/python3.10/site-packages (from pandas->datasets) (2022.1)
Requirement already satisfied: python-dateutil>=2.8.1 in /app/python/3.10.5/lib/python3.10/site-packages (from pandas->datasets) (2.8.2)
Requirement already satisfied: pycparser in /app/python/3.10.5/lib/python3.10/site-packages (from cffi>=1.0->soundfile>=0.12.1->librosa) (2.21)
Requirement already satisfied: six>=1.5 in /app/python/3.10.5/lib/python3.10/site-packages (from python-dateutil>=2.8.1->pandas->datasets) (1.16.0)

[notice] A new release of pip available: 22.3.1 -> 23.0.1
[notice] To update, run: pip install --upgrade pip
2023-03-28 16:07:47.488151: I tensorflow/core/util/util.cc:169] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
Some weights of ASTForAudioClassification were not initialized from the model checkpoint at MIT/ast-finetuned-audioset-10-10-0.4593 and are newly initialized because the shapes did not match:
- classifier.dense.weight: found shape torch.Size([527, 768]) in the checkpoint and torch.Size([25, 768]) in the model instantiated
- classifier.dense.bias: found shape torch.Size([527]) in the checkpoint and torch.Size([25]) in the model instantiated
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Could not find image processor class in the image processor config or the model config. Loading based on pattern matching with the model's feature extractor configuration.
Downloading and preparing dataset dataloader/daic_woz to /ibm/gpfs/home/snag0027/speech-depression/cluster/cache_daic_woz/dataloader/daic_woz-data_dir=./0.0.1/cf2fae118442033896014c711dddc696be7f5373884a2507dd9e45e7414cc556...
Generating train split: 0 examples [00:00, ? examples/s]                                                        19
2
16
10
11
3
0
1
10
9
0
16
7
8
1
7
8
16
5
3
13
12
2
12
0
11
0
9
3
15
0
5
7
12
4
0
15
22
0
1
11
5
3
10
16
11
7
4
8
14
1
1
1
14
1
3
0
0
11
11
7
5
13
2
1
1
2
9
18
8
9
1
7
7
5
6
17
0
7
12
4
10
4
1
0
0
17
3
0
3
7
1
3
15
3
0
5
2
2
10
10
18
0
1
9
6
9
4
3
1
9
0
17
3
15
16
7
17
3
8
7
23
2
3
3
1
2
9
11
0
7
21
7
6
18
0
10
1
0
2
10
13
5
19
4
2
5
0
2
3
12
Generating validation split: 0 examples [00:00, ? examples/s]                                                             4
20
10
12
5
0
2
4
4
20
10
0
12
4
0
6
10
2
0
7
Generating test split: 0 examples [00:00, ? examples/s]                                                       18
0
1
2
2
5
6
0
9
15
20
3
9
2
6
2
1
7
20
Dataset dataloader downloaded and prepared to /ibm/gpfs/home/snag0027/speech-depression/cluster/cache_daic_woz/dataloader/daic_woz-data_dir=./0.0.1/cf2fae118442033896014c711dddc696be7f5373884a2507dd9e45e7414cc556. Subsequent calls will reuse this data.
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 1167.79it/s]
Printing type
Dataset({
    features: ['file', 'audio', 'label'],
    num_rows: 20
})
Dataset({
    features: ['file', 'audio', 'label'],
    num_rows: 19
})
{'file': Value(dtype='string', id=None), 'audio': Audio(sampling_rate=16000, mono=True, decode=True, id=None), 'label': Value(dtype='int32', id=None)}
Map:   0%|          | 0/151 [00:00<?, ? examples/s]Map:   3%|▎         | 4/151 [00:32<19:51,  8.10s/ examples]Map:   5%|▌         | 8/151 [00:50<14:11,  5.96s/ examples]Map:   8%|▊         | 12/151 [01:18<15:02,  6.49s/ examples]Map:  11%|█         | 16/151 [01:38<13:17,  5.91s/ examples]Map:  13%|█▎        | 20/151 [02:13<15:02,  6.89s/ examples]Map:  16%|█▌        | 24/151 [02:34<13:25,  6.34s/ examples]Map:  19%|█▊        | 28/151 [02:53<11:55,  5.82s/ examples]Map:  21%|██        | 32/151 [03:16<11:27,  5.78s/ examples]Map:  24%|██▍       | 36/151 [03:42<11:36,  6.06s/ examples]Map:  26%|██▋       | 40/151 [04:01<10:24,  5.63s/ examples]Map:  29%|██▉       | 44/151 [04:28<10:40,  5.99s/ examples]Map:  32%|███▏      | 48/151 [04:53<10:20,  6.02s/ examples]Map:  34%|███▍      | 52/151 [05:19<10:11,  6.17s/ examples]Map:  37%|███▋      | 56/151 [05:34<08:37,  5.45s/ examples]Map:  40%|███▉      | 60/151 [05:52<07:54,  5.21s/ examples]Map:  42%|████▏     | 64/151 [06:20<08:14,  5.68s/ examples]Map:  45%|████▌     | 68/151 [06:35<07:03,  5.10s/ examples]Map:  48%|████▊     | 72/151 [06:52<06:24,  4.87s/ examples]Map:  50%|█████     | 76/151 [07:12<06:06,  4.88s/ examples]Map:  53%|█████▎    | 80/151 [07:43<06:48,  5.75s/ examples]Map:  56%|█████▌    | 84/151 [08:08<06:38,  5.94s/ examples]Map:  58%|█████▊    | 88/151 [08:39<06:47,  6.47s/ examples]Map:  61%|██████    | 92/151 [09:18<07:19,  7.44s/ examples]Map:  64%|██████▎   | 96/151 [09:46<06:41,  7.29s/ examples]Map:  66%|██████▌   | 100/151 [10:28<07:04,  8.32s/ examples]Map:  69%|██████▉   | 104/151 [10:49<05:45,  7.34s/ examples]Map:  72%|███████▏  | 108/151 [11:20<05:23,  7.51s/ examples]Map:  74%|███████▍  | 112/151 [11:42<04:28,  6.88s/ examples]Map:  77%|███████▋  | 116/151 [12:01<03:37,  6.22s/ examples]Map:  79%|███████▉  | 120/151 [12:31<03:25,  6.62s/ examples]Map:  82%|████████▏ | 124/151 [13:03<03:09,  7.02s/ examples]Map:  85%|████████▍ | 128/151 [13:29<02:39,  6.92s/ examples]Map:  87%|████████▋ | 132/151 [13:52<02:04,  6.54s/ examples]Map:  90%|█████████ | 136/151 [14:08<01:26,  5.74s/ examples]Map:  93%|█████████▎| 140/151 [14:26<00:59,  5.42s/ examples]Map:  95%|█████████▌| 144/151 [14:53<00:40,  5.77s/ examples]Map:  98%|█████████▊| 148/151 [15:22<00:18,  6.27s/ examples]Map: 100%|██████████| 151/151 [15:44<00:00,  6.50s/ examples]                                                             Map:   0%|          | 0/20 [00:00<?, ? examples/s]Map:  20%|██        | 4/20 [00:26<01:47,  6.70s/ examples]Map:  40%|████      | 8/20 [01:07<01:44,  8.74s/ examples]Map:  60%|██████    | 12/20 [01:28<00:56,  7.10s/ examples]Map:  80%|████████  | 16/20 [01:55<00:27,  6.98s/ examples]Map: 100%|██████████| 20/20 [02:41<00:00,  8.60s/ examples]                                                           Map:   0%|          | 0/19 [00:00<?, ? examples/s]Map:  21%|██        | 4/19 [00:36<02:18,  9.21s/ examples]Map:  42%|████▏     | 8/19 [00:52<01:06,  6.03s/ examples]Map:  63%|██████▎   | 12/19 [01:21<00:46,  6.61s/ examples]Map:  84%|████████▍ | 16/19 [01:48<00:20,  6.68s/ examples]Map: 100%|██████████| 19/19 [02:08<00:00,  6.69s/ examples]                                                           INFO:root:Starting training of pure AST model...
/home/snag0027/.local/lib/python3.10/site-packages/transformers/optimization.py:391: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
Train length:  151
Validation length:  20
Test length:  19
Printing sample
<class 'dict'>
<class 'numpy.ndarray'>
  0%|          | 0/36 [00:00<?, ?it/s]  3%|▎         | 1/36 [02:04<1:12:25, 124.14s/it]  6%|▌         | 2/36 [04:03<1:08:39, 121.18s/it]  8%|▊         | 3/36 [05:55<1:04:27, 117.20s/it] 11%|█         | 4/36 [07:43<1:00:31, 113.50s/it] 14%|█▍        | 5/36 [09:31<57:32, 111.38s/it]   17%|█▋        | 6/36 [11:20<55:24, 110.82s/it]                                                17%|█▋        | 6/36 [11:20<55:24, 110.82s/it] 19%|█▉        | 7/36 [13:03<52:15, 108.13s/it] 22%|██▏       | 8/36 [14:50<50:18, 107.81s/it] 25%|██▌       | 9/36 [16:38<48:32, 107.88s/it]{'loss': 3.3691, 'learning_rate': 4.166666666666667e-05, 'epoch': 0.63}

  0%|          | 0/5 [00:00<?, ?it/s][A
 40%|████      | 2/5 [00:04<00:07,  2.40s/it][A
 60%|██████    | 3/5 [00:09<00:06,  3.42s/it][A
 80%|████████  | 4/5 [00:14<00:03,  3.93s/it][A
100%|██████████| 5/5 [00:19<00:00,  4.23s/it][ATrainer is attempting to log a value of "{'accuracy': 0.2}" of type <class 'dict'> for key "eval/accuracy" as a scalar. This invocation of Tensorboard's writer.add_scalar() is incorrect so we dropped this attribute.
Trainer is attempting to log a value of "{'f1': 0.11153846153846154}" of type <class 'dict'> for key "eval/f1" as a scalar. This invocation of Tensorboard's writer.add_scalar() is incorrect so we dropped this attribute.
                                               
                                             [A 25%|██▌       | 9/36 [17:45<48:32, 107.88s/it]
100%|██████████| 5/5 [00:19<00:00,  4.23s/it][A
                                             [A 28%|██▊       | 10/36 [18:33<47:38, 109.93s/it] 31%|███       | 11/36 [20:14<44:40, 107.23s/it] 33%|███▎      | 12/36 [21:53<41:55, 104.81s/it]                                                 33%|███▎      | 12/36 [21:53<41:55, 104.81s/it] 36%|███▌      | 13/36 [23:34<39:41, 103.54s/it] 39%|███▉      | 14/36 [25:46<41:09, 112.24s/it]/cm/local/apps/slurm/var/spool/job09548/slurm_script: line 13: 2530093 Killed                  python /home/snag0027/speech-depression/cluster/train.py
slurmstepd: error: Detected 1 oom-kill event(s) in StepId=9548.batch. Some of your processes may have been killed by the cgroup out-of-memory handler.
